$(document).ready(function(){var n,t;$(".tooltip").tooltipster({theme:"tooltipster-borderless",side:"left"});$("#login_btn").click(function(){var n=$("#currentUrl").val().replace("Action_Id","Login");window.location.href=n});$("#reg_btn").click(function(){var n=$("#currentUrl").val().replace("Action_Id","Register");window.location.href=n});$("#sourceList").length&&$("#sourceList").change(function(){var n="/subsurface/"+$(this).attr("data-id")+"/"+$(this).val();location.href.indexOf("geology")>-1?n+="/geology":location.href.indexOf("works")>-1&&(n+="/works");window.location.href=n});$("header .login > button").bind("click",function(n){$(n.target).blur();$("header .login").toggleClass("opened")});$(document).bind("click",function(n){if(!$(n.target).closest(".login").length&&$("header .login").hasClass("opened"))return $("header .login").removeClass("opened"),!1});n=function(){var n=$(window).scrollTop(),t=!1;$.each($(".menu-block div.white ul li a"),function(i,r){var u,f,e,o;$($(r).attr("href")).length&&(u=$($(r).attr("href")).offset().top,f=$($(r).attr("href")).height(),n>=u-100&&n<=u+f&&($(r).hasClass("active")||($(".menu-block div.white ul li a.active").removeClass("active"),$(r).addClass("active")),$(".menu-block .smailer").show(),e=$(r).closest("li").position().left+11,o=$(r).closest("li").width(),$(".menu-block .smailer").show(),$(".menu-block .smailer").css("left",e),$(".menu-block .smailer").css("width",o),t=!0))});t||($(".menu-block div.white ul li a.active").removeClass("active"),$(".menu-block .smailer").hide())};$(document).bind("scroll",function(){var t=$(window).scrollTop();$(".menu-block").parent().offset().top-t>-60?$(".menu-block").removeClass("fixed"):$(".menu-block").addClass("fixed");n()});t=$(".menu-block ul").length;$(".menu-block ul:nth-child("+(t-1)+") li a").bind("click",function(n){if($($(n.target).attr("href")).length){location.hash=$(n.target).attr("href");var t=$($(n.target).attr("href")).offset().top-90;return $("html, body").stop().animate({scrollTop:t},500,"swing"),!1}});$(".menu-block").bind("mouseleave",function(){n()});setTimeout(function(){n()},0);$(".simple-html-tooltip").length&&$(".simple-html-tooltip").tooltipster({trigger:"hover",onlyOne:!0,touchDevices:!0,maxWidth:$(window).width()/2,repositionOnScroll:!0,touchDevices:!0,contentAsHTML:!0,interactive:!0,position:"right",functionInit:function(n,t){var i=$("#"+$(t.origin).attr("tooltip-content-id")).html();n.content(i)}});$("#add-to-favorites").bind("click",function(n){var t;$("#add-to-favorites").attr("data-user-authenticated").toLowerCase()=="true"?$("#add-to-favorites").hasClass("added")?(t=$(this).attr("data-favorite-id"),$.ajax({url:"/api/favorites/remove_favorite?favoriteId="+t,dataType:"json",type:"POST",success:function(t){!!t&&t.IsSuccessful&&($("#add-to-favorites").attr("data-favorite-id",""),$("#add-to-favorites").removeClass("added"),$(".is-favorite").show(),$(n.currentTarget).closest("button").tooltipster("content",globalVars.consts.AddToFavorites))}})):(t=$(this).attr("data-id"),$.ajax({url:"/api/favorites/add_subsurface?subsurfaceId="+t,dataType:"json",type:"POST",success:function(t){!!t&&t.IsSuccessful&&($("#add-to-favorites").attr("data-favorite-id",t.favoriteId),$("#add-to-favorites").addClass("added"),$(".is-favorite").hide(),$(n.currentTarget).closest("button").tooltipster("content",globalVars.consts.RemoveFroFavorites))}})):(t=$(this).attr("data-id"),$("#currentUrl").val($("#subsurfaceUrl").val().replace("subsurface_value_id",t)),$.magnificPopup.open({items:{src:"#to-liked-dialog"},type:"inline"}))});$("#get-rating-button").bind("click",function(){var t=this,n;$(this).attr("data-valuation").toLowerCase()=="true"||$(this).attr("data-authenticated").toLowerCase()=="false"?($(this).attr("data-valuation").toLowerCase()=="true"&&$("#get-rating .text > p").html($("#get-rating .text > input[type='hidden']").val()),$.magnificPopup.open({items:{src:"#get-rating"},type:"inline"})):(n=$(this).attr("data-id"),$.ajax({url:"/api/subsurface/request_valuation?informationId="+n,dataType:"json",type:"POST",success:function(n){!!n&&n.result?($(t).attr("data-valuation","true"),$.magnificPopup.open({items:{src:"#get-rating"},type:"inline"}),!n.favoriteId||($("#add-to-favorites").addClass("added"),$("#add-to-favorites").attr("data-favorite-id",n.favoriteId))):console.log(n.Error)}}))});$("#to-licensing-button").bind("click",function(){var t=this,n;$(this).attr("data-offered").toLowerCase()=="true"||$(this).attr("data-authenticated").toLowerCase()=="false"?($(this).attr("data-offered").toLowerCase()=="true"&&$("#to-licensing .text > p").text($("#to-licensing .text > input[type='hidden']").val()),$.magnificPopup.open({items:{src:"#to-licensing"},type:"inline"})):(n=$(this).attr("data-id"),$.ajax({url:"/api/subsurface/offer_licensing?informationId="+n,dataType:"json",type:"POST",success:function(n){!!n&&n.result?($(t).attr("data-offered","true"),$.magnificPopup.open({items:{src:"#to-licensing"},type:"inline"}),!n.favoriteId||($("#add-to-favorites").addClass("added"),$("#add-to-favorites").attr("data-favorite-id",n.favoriteId))):console.log(n.Error)}}))});$(".load-more-subsurfaces").bind("click",function(){$(".subsurfaces-list li").show();$(this).hide();$(".pagination-block-subsurface label span").text($(".subsurfaces-list li").length)});$(".load-more-documents").bind("click",function(){$(".documents-list li").show();$(this).hide();$(".pagination-block-documents label span").text($(".subsurfaces-list li").length)});$(".add-to-liked-document").bind("click",function(n){var i=this,t;return $(this).attr("data-user-authenticated").toLowerCase()=="true"?$(this).hasClass("added")?(t=$(this).attr("data-favorite-id"),$.ajax({url:"/api/favorites/remove_favorite?favoriteId="+t,dataType:"json",type:"POST",success:function(t){!!t&&t.IsSuccessful&&($(i).attr("data-favorite-id",""),$(i).removeClass("added"),$(n.currentTarget).closest("button").tooltipster("content",globalVars.consts.AddToFavorites))}})):(t=$(this).attr("data-id"),$.ajax({url:"/api/favorites/add_document?documentId="+t,dataType:"json",type:"POST",success:function(t){!!t&&t.IsSuccessful&&($(i).attr("data-favorite-id",t.favoriteId),$(i).addClass("added"),$(n.currentTarget).closest("button").tooltipster("content",globalVars.consts.RemoveFroFavorites))}})):(t=$(this).attr("data-id"),$("#currentUrl").val($("#documentUrl").val().replace("document_value_id",t)),$.magnificPopup.open({items:{src:"#to-liked-dialog"},type:"inline"})),!1});$(".add-to-liked-subsurface").bind("click",function(n){var i=this,t;return $(this).attr("data-user-authenticated").toLowerCase()=="true"?$(this).hasClass("added")?(t=$(this).attr("data-favorite-id"),$.ajax({url:"/api/favorites/remove_favorite?favoriteId="+t,dataType:"json",type:"POST",success:function(t){!!t&&t.IsSuccessful&&($(i).attr("data-favorite-id",""),$(i).removeClass("added"),$(n.currentTarget).closest("button").tooltipster("content",globalVars.consts.AddToFavorites))}})):(t=$(this).attr("data-id"),$.ajax({url:"/api/favorites/add_subsurface?subsurfaceId="+t,dataType:"json",type:"POST",success:function(t){!!t&&t.IsSuccessful&&($(i).attr("data-favorite-id",t.favoriteId),$(i).addClass("added"),$(n.currentTarget).closest("button").tooltipster("content",globalVars.consts.RemoveFroFavorites))}})):(t=$(this).attr("data-id"),$("#currentUrl").val($("#subsurfaceUrl").val().replace("subsurface_value_id",t)),$.magnificPopup.open({items:{src:"#to-liked-dialog"},type:"inline"})),!1})})