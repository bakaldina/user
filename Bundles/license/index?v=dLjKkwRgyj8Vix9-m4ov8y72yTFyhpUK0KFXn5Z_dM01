$(document).ready(function(){var n,t;$("#login_btn").click(function(){var n=$("#currentUrl").val().replace("Action_Id","Login");window.location.href=n});$("#reg_btn").click(function(){var n=$("#currentUrl").val().replace("Action_Id","Register");window.location.href=n});$(".tooltip").tooltipster({theme:"tooltipster-borderless",side:"left"});n=function(){var n=$(window).scrollTop(),t=!1;$.each($(".menu-block div ul li a"),function(i,r){var u,f,e,o;$(r).attr("href").startsWith("#")&&!!$($(r).attr("href")).length&&(u=$($(r).attr("href")).offset().top,f=$($(r).attr("href")).height(),n>=u-100&&n<=u+f&&($(r).hasClass("active")||($(".menu-block div ul li a.active").removeClass("active"),$(r).addClass("active")),$(".menu-block .smailer").show(),e=$(r).closest("li").position().left+11,o=$(r).closest("li").width(),$(".menu-block .smailer").show(),$(".menu-block .smailer").css("left",e),$(".menu-block .smailer").css("width",o),t=!0))});t||($(".menu-block div ul li a.active").removeClass("active"),$(".menu-block .smailer").hide())};$(document).bind("scroll",function(){var t=$(window).scrollTop();$(".menu-block").parent().offset().top-t>-60?$(".menu-block").removeClass("fixed"):$(".menu-block").addClass("fixed");n()});t=$(".menu-block ul").length;$(".menu-block ul:nth-child("+(t-1)+") li a").bind("click",function(n){if($($(n.target).attr("href")).length)return location.hash=$(n.target).attr("href"),$("html, body").stop().animate({scrollTop:$($(n.target).attr("href")).offset().top-50},500,"swing"),!1});$(".menu-block").bind("mouseleave",function(){n()});setTimeout(function(){n()},0);$("#add-to-favorites").bind("click",function(n){var t;$("#add-to-favorites").attr("data-user-authenticated").toLowerCase()=="true"?$("#add-to-favorites").hasClass("added")?(t=$(this).attr("data-favorite-id"),$.ajax({url:"/api/favorites/remove_favorite?favoriteId="+t,dataType:"json",type:"POST",success:function(t){!!t&&t.IsSuccessful&&($("#add-to-favorites").attr("data-favorite-id",""),$("#add-to-favorites").removeClass("added"),$(n.currentTarget).closest("button").tooltipster("content",globalVars.consts.AddToFavorites))}})):(t=$(this).attr("data-id"),$.ajax({url:"/api/favorites/add_subsurface?subsurfaceId="+t,dataType:"json",type:"POST",success:function(t){!!t&&t.IsSuccessful&&($("#add-to-favorites").attr("data-favorite-id",t.favoriteId),$("#add-to-favorites").addClass("added"),$(n.currentTarget).closest("button").tooltipster("content",globalVars.consts.RemoveFroFavorites))}})):(t=$(this).attr("data-id"),$("#currentUrl").val($("#subsurfaceUrl").val().replace("subsurface_value_id",t)),$.magnificPopup.open({items:{src:"#to-liked-dialog"},type:"inline"}))});$(".add-to-liked:not(.parent)").bind("click",function(n){var i=this,r,t;$(this).attr("data-user-authenticated").toLowerCase()=="true"?$(this).hasClass("added")?(t=$(this).attr("data-favorite-id"),$.ajax({url:"/api/favorites/remove_favorite?favoriteId="+t,dataType:"json",type:"POST",success:function(t){!!t&&t.IsSuccessful&&($(i).attr("data-favorite-id",""),$(i).removeClass("added"),$(n.currentTarget).closest("button").tooltipster("content","Добавить в избранное"))}})):(t=$(this).attr("data-id"),r="",$(this).hasClass("subsurface")?r="add_subsurface?subsurfaceId=":$(this).hasClass("document")&&(r="add_document?documentId="),$.ajax({url:"/api/favorites/"+r+t,dataType:"json",type:"POST",success:function(t){!!t&&t.IsSuccessful&&($(i).attr("data-favorite-id",t.favoriteId),$(i).addClass("added"),$(n.currentTarget).closest("button").tooltipster("content","Удалить из избранного"))}})):(t=$(this).attr("data-id"),$(this).hasClass("subsurface")?$("#currentUrl").val($("#subsurfaceUrl").val().replace("subsurface_value_id",t)):$(this).hasClass("document")&&$("#currentUrl").val($("#documentUrl").val().replace("document_value_id",t)),$.magnificPopup.open({items:{src:"#to-liked-dialog"},type:"inline"}))})})